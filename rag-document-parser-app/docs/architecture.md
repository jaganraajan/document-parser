# Architecture Overview

## Phase 1 – Core RAG Pipeline

### 1. Document Ingestion
- **PDF Parsing**: The application utilizes `pdf_loader.py` to load and parse PDF documents.
- **Metadata Extraction**: Metadata is extracted according to the schema defined in `metadata_schema.py`.
- **Normalization**: The extracted metadata values are normalized using functions in `normalizer.py`.
- **Text Chunking**: The text is chunked into manageable pieces using `chunker.py` for efficient processing.

### 2. Embedding & Storage
- **Vectorization**: Content is vectorized using best-practice embeddings implemented in `embedder.py`.
- **Storage**: Vectors are stored and retrieved in a vector database (e.g., Pinecone) using `vector_store.py`, with stable IDs generated by `id_strategy.py`.

### 3. Contextual Retrieval & LLM Response
- **Retrieval**: The application retrieves relevant documents based on user queries using `retriever.py`.
- **LLM Integration**: It integrates with free LLM APIs through `responder.py`, utilizing prompt templates from `prompts.py` and applying metadata filters for contextual responses.

### 4. Logging & Evaluation
- **Logging**: Events and actions are logged using `audit_logger.py` to track system behavior.
- **Evaluation**: The accuracy of retrieval and prompt variations are evaluated using functions in `metrics.py` and benchmarks are run with `benchmark_runner.py`.

## Phase 2 – Interface & Usability

### 1. API Development
- **API Setup**: A lightweight API is developed in `main.py`, with routes for document ingestion and querying defined in `ingest.py` and `query.py`.

### 2. Metadata-Aware Retrieval
- **Filtering**: The retrieval process supports metadata-aware filters for jurisdiction, framework, document type, and date, ensuring users can refine their queries effectively.

## Conclusion
This architecture provides a robust framework for building a document parser application that leverages RAG (Retrieval-Augmented Generation) techniques, ensuring efficient document ingestion, contextual retrieval, and user-friendly interaction.